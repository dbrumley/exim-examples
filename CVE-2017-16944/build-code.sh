#!/usr/bin/env bash
#

PROJ_ROOT=`pwd`

# Check if an argument is provided
if [ $# -eq 0 ]; then
    echo "Must provide a Makefile"
    echo "Usage: $0 filename"
    exit 1
fi

filename="$1"

# Check if the file exists
if [ ! -f "$filename" ]; then
    echo "Error: File '$filename' not found."
    exit 1
fi 

full_path=$(realpath "$filename")

git clone https://github.com/Exim/exim.git

cd exim
git checkout 01c594601670c7e48e676d6c6d32d0f0084067fa

cd src

mkdir Local
cp $full_path Local/Makefile


sudo make install
cd $PROJ_ROOT
sudo cp configure /usr/exim/configure

sudo echo "postmaster: exim" >> /etc/aliases
